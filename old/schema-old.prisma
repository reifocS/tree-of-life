generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Tree {
  id       Int     @id @default(autoincrement())
  label    String  
  branches Branch[]
  treeConsultation Consultation[]  @relation("treeConsultation")
}

model Branch {
  id    Int    @id @default(autoincrement())
  label String 
  treeId Int 
  tree  Tree   @relation(fields: [treeId], references: [id])
  leafs Leaf[]
}

model Leaf {
  id     Int    @id @default(autoincrement())
  label  String 
  branchId Int 
  branch  Branch   @relation(fields: [branchId], references: [id])
}

model User {
  id      Int    @id @default(autoincrement())
  nom     String
  roleID Int 
  role  Role   @relation(fields: [roleID], references: [id])
  soignantConsultation Consultation[]  @relation("soignantConsultation")
  patientConsultation   Consultation[]   @relation("patientConsultation")
}

model Role {
  id     Int    @id
  label  String 
  user User[]
}

// consultation = user patient + user soignant

model Consultation {
  id Int @id @default(autoincrement())
  date DateTime @default(now())
  patientID Int 
  soignantID Int 
  treeID Int
  patient  User   @relation("soignantConsultation",fields: [patientID], references: [id])
  soignant  User   @relation("patientConsultation",fields: [soignantID], references: [id])
  tree  Tree   @relation("treeConsultation",fields: [treeID], references: [id])

}


// npx prisma migrate dev --name init
